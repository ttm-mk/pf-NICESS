<div class="container">
  <div class="row">
    <div class="col-12 col-lg-8 order-1 order-lg-0">
      <!-- 投稿 -->
      <div>
        <%= form_with model: @post, url: user_posts_path(params[:id]), method: :post do |f| %>
          <div class="form-group">
            <%= f.text_area :text, rows: 5, class: 'form-control' %>
          </div>

          <div class="row">
            <div class="col-12 col-md-8">
              <div class="form-group">
                <%= f.file_field :image, accept: 'image/*' %>
              </div>
            </div>
            <div class="col-12 col-md-4">
              <div class="form-group">
                <%= f.submit '投稿する', class: 'btn btn-light btn-block' %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
      <!-- タブ -->
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item w-25 text-center">
          <a class="nav-link active" id="post-tab" data-toggle="tab" href="#post" role="tab" aria-selected="true">
            投稿
          </a>
        </li>
        <li class="nav-item w-25 text-center">
          <a class="nav-link" id="image-tab" data-toggle="tab" href="#image" role="tab" aria-selected="true">
            画廊
          </a>
        </li>
        <li class="nav-item w-25 text-center">
          <a class="nav-link" id="favorite-tab" data-toggle="tab" href="#favorite" role="tab" aria-selected="true">
            いいね
          </a>
        </li>
        <li class="nav-item w-25 text-center">
          <a class="nav-link" id="follow-tab" data-toggle="tab" href="#follow" role="tab" aria-selected="true">
            フォロー
          </a>
        </li>
        <% if @user == current_user %>
          <li class="nav-item w-100 text-center">
            <a class="nav-link" id="mypage-tab" data-toggle="tab" href="#mypage" role="tab" aria-selected="false">
              マイ情報
            </a>
          </li>
        <% end %>
      </ul>

      <!-- タブコンテンツ -->
      <div class="tab-content" id="myTabContent">
      <!--投稿-->
        <div class="tab-pane fade show active" id="post" role="tabpanel" aria-labelledby="post-tab">
          <%= render 'public/posts/index', posts: @user.posts.reverse.take(3), user: @user %>
          <div class="text-right">
            <%= link_to user_posts_path(params[:id]) do %>
              <i class="fas fa-angle-double-right"></i> More
            <% end %>
          </div>
        </div>
        <!--画像あり投稿-->
        <div class="tab-pane fade" id="image" role="tabpanel" aria-labelledby="image-tab">
          <%= render 'public/posts/image', posts: @user.posts.reverse, user: @user %>
        </div>
        <!--いいね-->
        <div class="tab-pane fade" id="favorite" role="tabpanel" aria-labelledby="favorite-tab">
          <%= render 'public/posts/favorite', favorite_posts: @favorite_posts.reverse %>
        </div>
        <!--フォロー-->
        <div class="tab-pane fade" id="follow" role="tabpanel" aria-labelledby="follow-tab">
          <%= render 'public/relationships/relationship',  following_users: @following_users %>
        </div>
        <!--マイ情報-->
        <div class="tab-pane fade" id="mypage" role="tabpanel" aria-labelledby="mypage-tab">
          <%= render 'public/users/mypage', user: @user %>
        </div>
      </div>

    </div>

    <!--プロフィール-->
    <div class="col-12 col-lg-4 mb-5 mb-lg-0 order-0 order-lg-1">
      <div class="card">
        <div class="card-body">
          <div class="row">
            <div class="col-12 col-md-4">
              <%= image_tag @user.get_user_icon(100,100) %>
            </div>
            <div class="col-12 col-md-8 d-flex justify-content-center align-items-center">
              <h6 class="card-title">
                <%= @user.name %>
              </h6>
            </div>
          </div>
          <% if @user.profile.present? %>
            <div class="mt-3">
              <%= simple_format(@user.profile) %>
            </div>
          <% end %>
          <div class="my-2">
            <% if current_user.id == @user.id %>

            <% elsif current_user.following?(@user) %>
              <%= link_to "フォローを外す", user_relationships_path(@user.id), method: :delete, class: 'btn btn-light' %>
            <% else %>
              <%= link_to "フォローする", user_relationships_path(@user.id), method: :post, class: 'btn btn-primary' %>
            <% end %>
          </div>
        </div>
    </div>

    <h5 class="mt-3">ショップ</h5>

    <!-- Slider main container -->
    <div class="swiper">
      <!-- Additional required wrapper -->
      <div class="swiper-wrapper">
        <!-- Slides -->
        <% (1..10).each do |item| %>
        <div class="swiper-slide">

          <div class="card">
            <!-- svgはimage_tagに最終的に書き換える -->
            <svg class="bd-placeholder-img card-img-top" width="100%" height="180" xmlns="http://www.w3.org/2000/svg"
                        preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Image cap">
              <title>Placeholder</title>
              <rect fill="#868e96" width="100%" height="100%"/><text fill="#dee2e6" dy=".3em" x="50%" y="50%">商品画像</text>
            </svg>
            <!-- ここまでsvg -->

            <div class="card-body px-5">
              <div class="card-title">
                色紙セット<%= item %>
              </div>

              <div class="card-text">
                <div class="pt-3">
                  テーマ「鋼」の色紙3枚セット。<br>
                  ・消えない痕跡<br>
                  ・腐敗<br>
                  ・軌跡<br>
                  各サイズ(20×20)<br>
                </div>
                <div class="pt-3">
                  <div class="pt-2">
                    価格
                  </div>
                  <div>100円</div>
                </div>
                <div class="btn btn-primary mt-3 form-control">
                詳細
                </div>
              </div>
            </div>

          </div>

        </div>

      <% end %>

      </div>

      <!-- If we need navigation buttons -->
      <div class="swiper-button-prev fa-fw fa-2x">
        <i class="fas fa-arrow-circle-left"></i>
      </div>
      <div class="swiper-button-next fa-fw fa-2x">
        <i class="fas fa-arrow-circle-right"></i>
      </div>
    </div>
  </div>
</div>